---
import PlotFigure from "./PlotFigure.astro";
import * as Plot from "@observablehq/plot";
import penguins from "../assets/penguins.json";

interface Props { species: "Adelie" | "Gentoo" | "Chinstrap"; title?: string }
const { species, title = `Graphique — ${species}` } = Astro.props;

const data = penguins.filter(
  (d) =>
    d.species === species &&
    d.culmen_length_mm != null &&
    d.culmen_depth_mm != null
);

const options = {
  width: 860,
  height: 480,
  marks: [
    Plot.dot(data, {
      x: "culmen_length_mm",
      y: "culmen_depth_mm",
      r: 3.5,
      opacity: 0.9,
      tip: true,
    }),
  ],
  x: { label: "Longueur du bec (mm)", grid: true },
  y: { label: "Profondeur du bec (mm)", grid: true },
  color: { legend: false }, // 1 seule espèce
};
---
<h2 class="text-2xl font-semibold mb-2">{title}</h2>
<p class="text-gray-500 mb-4">Espèce : {species} — {data.length} lignes</p>
<PlotFigure options={options} />
